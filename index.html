<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Calories</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <h1>Ajouter les calories manuellement</h1>
  
  <form id="caloriesForm">
    <label for="dateInput">Date (jj-mm-aaaa) :</label>
    <input type="text" id="dateInput" name="date" placeholder="ex: 24-05-2025" required pattern="\d{2}-\d{2}-\d{4}" />
    <br /><br />
    
    <label for="caloriesInput">Calories :</label>
    <input type="number" id="caloriesInput" name="calories" min="0" required />
    <br /><br />
    
    <button type="submit">Envoyer</button>
  </form>

  <p id="message"></p>

  <script>
    // Configuration Firebase (remplace par la tienne)
    const firebaseConfig = {
      apiKey: "AIzaSyA2LfuviRqEAy4MI7pRG-LcAF2x6iLyF3k",
      authDomain: "nutrition-ff18c.firebaseapp.com",
      projectId: "nutrition-ff18c",
      storageBucket: "nutrition-ff18c.firebasestorage.app",
      messagingSenderId: "926868946162",
      appId: "1:926868946162:web:983919b8b7915da71c246b",
      measurementId: "G-LHD9300KHH"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Gérer la soumission du formulaire
    document.getElementById('caloriesForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const date = document.getElementById('dateInput').value;
      const calories = parseInt(document.getElementById('caloriesInput').value);

      if (!date || isNaN(calories)) {
        document.getElementById('message').textContent = 'Veuillez remplir correctement le formulaire.';
        return;
      }

      try {
        await db.collection('calories').doc(date).set({
          date: date,
          calories: calories
        });
        document.getElementById('message').textContent = `Données enregistrées pour le ${date} (${calories} calories).`;
        e.target.reset();
      } catch (error) {
        console.error('Erreur enregistrement:', error);
        document.getElementById('message').textContent = 'Erreur lors de l\'enregistrement.';
      }
    });
  </script>
</body>
</html>
